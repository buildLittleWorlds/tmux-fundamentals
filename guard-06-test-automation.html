<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Automation That Guards &mdash; tmux for AI-Powered Development</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header>
    <div class="container">
      <p class="site-label">tmux + AI CLI</p>
      <h1><a href="index.html">tmux for AI-Powered Development</a></h1>
      <nav>
        <a href="index.html">Tracks</a>
        <span class="track-label">Guardrails for Speed</span>
      </nav>
    </div>
  </header>

  <main class="container">

    <!-- SLOGAN BANNER -->
    <div class="slogan-banner">
      <span class="main-slogan">See everything. Control everything.</span>
      <span class="subtext">Interactive tutorials for mastering tmux with Claude Code and Codex CLI.</span>
    </div>

    <!-- PAGE TITLE -->
    <h1 class="page-title">Test Automation That Guards</h1>

    <!-- LESSON METADATA -->
    <div class="course-meta">
      <span class="meta-pill">Lesson <strong>6</strong> of 10</span>
      <span class="meta-pill"><strong>Intermediate</strong></span>
      <span class="meta-pill">Track: Guardrails for Speed</span>
    </div>

    <!-- LEAD PARAGRAPH -->
    <p class="lead">Not all tests are equal as guardrails. A test suite with 100% coverage that breaks every time the agent touches a file is worse than useless&mdash;it generates noise. The guardrail question isn&rsquo;t &ldquo;how much coverage?&rdquo; but &ldquo;will this test catch a real regression without blocking legitimate changes?&rdquo;</p>

    <!-- CONCEPT: Tests as Guardrails vs. Tests as Noise -->
    <h2>Tests as Guardrails vs. Tests as Noise</h2>

    <table class="tool-table">
      <thead>
        <tr>
          <th>Characteristic</th>
          <th>Guardrail Tests</th>
          <th>Noise Tests</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>Tests&hellip;</strong></td>
          <td>Behavior and outcomes</td>
          <td>Implementation details</td>
        </tr>
        <tr>
          <td><strong>Breaks when&hellip;</strong></td>
          <td>Behavior changes</td>
          <td>Any code is touched</td>
        </tr>
        <tr>
          <td><strong>After AI refactoring&hellip;</strong></td>
          <td>Still passes (good)</td>
          <td>Fails everywhere (bad)</td>
        </tr>
        <tr>
          <td><strong>Generated by AI&hellip;</strong></td>
          <td>Needs careful review</td>
          <td>Passes but guards nothing</td>
        </tr>
        <tr>
          <td><strong>Value over time</strong></td>
          <td>Increases</td>
          <td>Decreases</td>
        </tr>
      </tbody>
    </table>

    <!-- CONCEPT: The Scenario Mindset -->
    <h2>The Scenario Mindset</h2>

    <ul>
      <li>Don&rsquo;t test classes or methods. Test <strong>scenarios</strong>: &ldquo;given these inputs, this behavior should produce these outcomes.&rdquo;</li>
      <li>A single scenario test through your public API exercises multiple classes, methods, and edge cases.</li>
      <li>Example: don&rsquo;t test <code>calculateDiscount()</code> in isolation. Test &ldquo;when a customer with a loyalty card buys 3+ items, the total reflects the loyalty discount.&rdquo;</li>
      <li>This approach means your tests survive when the agent refactors internal code&mdash;because the scenario hasn&rsquo;t changed even if the implementation has.</li>
    </ul>

    <!-- CONCEPT: The AI Test Generation Trap -->
    <h2>The AI Test Generation Trap</h2>

    <p>It&rsquo;s tempting to ask Claude to &ldquo;write tests for 100% coverage.&rdquo; The resulting tests often:</p>

    <ul>
      <li>Test implementation details (method calls, internal state)</li>
      <li>Break on any refactoring</li>
      <li>Pass trivially (testing that a mock returns what you told it to return)</li>
      <li>Create false confidence</li>
    </ul>

    <p>Better prompt: &ldquo;Write tests that verify these acceptance criteria: [list specific scenarios]&rdquo;</p>

    <div class="callout warning">
      <p><strong>Bad:</strong> &ldquo;Write unit tests for UserService.ts&rdquo; &rarr; tests every private method, breaks on refactoring</p>
    </div>

    <div class="callout success">
      <p><strong>Good:</strong> &ldquo;Write tests for: 1) new user registration creates account and sends welcome email, 2) duplicate email returns error, 3) expired verification link shows re-send option&rdquo; &rarr; tests behavior, survives refactoring</p>
    </div>

    <!-- CONCEPT: Running Tests in the Agentic Loop -->
    <h2>Running Tests in the Agentic Loop</h2>

    <p>From <a href="guard-05-hooks-as-guardrails.html">Lesson 5</a> (hooks), you can wire tests into PostToolUse. But there&rsquo;s a token budget concern: full test output floods context.</p>

    <p>Use a wrapper script that only outputs on failure:</p>

    <div class="skill-file">
      <div class="skill-file-header">test-quiet.sh &mdash; silent on success, verbose on failure</div>
      <div class="copy-wrapper">
        <button class="copy-btn">Copy</button>
        <pre>#!/bin/bash
# test-quiet.sh â€” silent on success, verbose on failure
OUTPUT=$(npm test 2>&amp;1)
EXIT=$?
if [ $EXIT -ne 0 ]; then
  # Only show the last 30 lines on failure
  echo "$OUTPUT" | tail -30 &gt;&amp;2
  exit 2
fi
echo "All tests passing."
exit 0</pre>
      </div>
    </div>

    <!-- EXERCISE -->
    <h2>Exercise</h2>

    <div class="step-card">
      <span class="step-number">1</span>
      <span class="step-title">Classify your existing tests</span>
      <div class="step-content">
        <p>Look at a test file in your project (or one from the beginner tracks). Classify each test: does it test behavior/scenarios, or implementation details?</p>
      </div>
    </div>

    <div class="step-card">
      <span class="step-number">2</span>
      <span class="step-title">Write a scenario test</span>
      <div class="step-content">
        <p>Write one new scenario test that describes a user-facing behavior. Use the given/when/then pattern: given a specific setup, when a specific action occurs, then a specific outcome should result.</p>
      </div>
    </div>

    <div class="step-card">
      <span class="step-number">3</span>
      <span class="step-title">Run it with the quiet wrapper</span>
      <div class="step-content">
        <p>Save the wrapper script above as <code>test-quiet.sh</code>, make it executable, and run your tests through it:</p>
        <div class="copy-wrapper">
          <button class="copy-btn">Copy</button>
          <div class="terminal-block">chmod +x test-quiet.sh
./test-quiet.sh</div>
        </div>
        <p>Verify: green output is silent (just &ldquo;All tests passing.&rdquo;), failure output is informative (last 30 lines of test output).</p>
      </div>
    </div>

    <!-- CHECKPOINT -->
    <h2>Checkpoint</h2>

    <ul class="checklist">
      <li>Guardrail tests verify behavior, not implementation details</li>
      <li>Test scenarios (given/when/then), not individual methods</li>
      <li>AI-generated tests need careful review&mdash;coverage &ne; quality</li>
      <li>Quiet test runners save token budget by only reporting failures</li>
      <li>Tests should survive agent refactoring without breaking</li>
    </ul>

    <!-- WHAT'S NEXT -->
    <div class="callout success">
      <p><strong>What&rsquo;s Next:</strong> In <a href="guard-07-shift-left.html">Lesson 7: Shift Left</a>, you&rsquo;ll move all these guardrails into the agentic loop so problems get caught and fixed before you ever see the code.</p>
    </div>

    <!-- DIVIDER -->
    <div class="divider"></div>

    <!-- PAGE NAVIGATION (Prev/Next) -->
    <nav class="page-nav">
      <a href="guard-05-hooks-as-guardrails.html" class="prev">Hooks as Guardrails</a>
      <a href="guard-07-shift-left.html" class="next">Shift Left</a>
    </nav>

    <!-- BOTTOM SITE NAVIGATION (Track-grouped) -->
    <nav class="site-nav-bottom">
      <h3>All Lessons</h3>
      <ul>
        <!-- Getting Started -->
        <li class="nav-phase-label">Getting Started</li>
        <li><a href="setup.html">Setup &amp; Configuration</a></li>

        <!-- Track 1: tmux + Claude Code -->
        <li class="nav-phase-label">Beginner: tmux + Claude Code</li>
        <li><a href="claude-01-first-session.html">1. Your First Session</a></li>
        <li><a href="claude-02-detach-reattach.html">2. Detach &amp; Reattach</a></li>
        <li><a href="claude-03-split-panes.html">3. Split Panes</a></li>
        <li><a href="claude-04-launch-claude.html">4. Launch Claude Code</a></li>
        <li><a href="claude-05-supervisor-workflow.html">5. Supervisor Workflow</a></li>
        <li><a href="claude-06-windows.html">6. Windows</a></li>
        <li><a href="claude-07-background-tasks.html">7. Background Tasks</a></li>
        <li><a href="claude-08-copy-mode.html">8. Copy Mode</a></li>
        <li><a href="claude-09-headless-sessions.html">9. Headless Sessions</a></li>
        <li><a href="claude-10-putting-it-together.html">10. Putting It Together</a></li>

        <!-- Track 2: tmux + Codex CLI -->
        <li class="nav-phase-label">Beginner: tmux + Codex CLI</li>
        <li><a href="codex-01-first-session.html">1. Your First Session</a></li>
        <li><a href="codex-02-detach-reattach.html">2. Detach &amp; Reattach</a></li>
        <li><a href="codex-03-split-panes.html">3. Split Panes</a></li>
        <li><a href="codex-04-launch-codex.html">4. Launch Codex CLI</a></li>
        <li><a href="codex-05-supervisor-workflow.html">5. Supervisor Workflow</a></li>
        <li><a href="codex-06-windows.html">6. Windows</a></li>
        <li><a href="codex-07-multitasking.html">7. Multitasking</a></li>
        <li><a href="codex-08-copy-mode.html">8. Copy Mode</a></li>
        <li><a href="codex-09-headless-sessions.html">9. Headless Sessions</a></li>
        <li><a href="codex-10-putting-it-together.html">10. Putting It Together</a></li>

        <!-- Track 3: Multi-Agent Orchestration -->
        <li class="nav-phase-label">Advanced: Multi-Agent Orchestration</li>
        <li><a href="parallel-01-multi-session-architecture.html">1. Multi-Session Architecture</a></li>
        <li><a href="parallel-02-launching-agents.html">2. Launching the Agents</a></li>
        <li><a href="parallel-03-assigning-tasks.html">3. Assigning Tasks</a></li>
        <li><a href="parallel-04-control-dashboard.html">4. Control Dashboard</a></li>
        <li><a href="parallel-05-integration-point.html">5. Integration Point</a></li>
        <li><a href="parallel-06-synchronized-commands.html">6. Synchronized Commands</a></li>
        <li><a href="parallel-07-conflict-resolution.html">7. Conflict Resolution</a></li>
        <li><a href="parallel-08-session-scripts.html">8. Session Scripts</a></li>
        <li><a href="parallel-09-capture-review.html">9. Capture &amp; Review</a></li>
        <li><a href="parallel-10-complete-workflow.html">10. Complete Workflow</a></li>

        <!-- Track 4: Developer Toolkit -->
        <li class="nav-phase-label">Advanced: Developer Toolkit</li>
        <li><a href="dx-01-skeleton.html">1. The dx Skeleton</a></li>
        <li><a href="dx-02-choosing-ai.html">2. Choosing Your AI</a></li>
        <li><a href="dx-03-review-command.html">3. Review Command</a></li>
        <li><a href="dx-04-pr-command.html">4. PR Command</a></li>
        <li><a href="dx-05-explain-command.html">5. Explain Command</a></li>
        <li><a href="dx-06-test-command.html">6. Test Command</a></li>
        <li><a href="dx-07-standup-command.html">7. Standup Command</a></li>
        <li><a href="dx-08-popup-mode.html">8. Popup Mode</a></li>
        <li><a href="dx-09-background-watchers.html">9. Background Watchers</a></li>
        <li><a href="dx-10-installation.html">10. Installation</a></li>

        <!-- Track 5: Guardrails for Speed -->
        <li class="nav-phase-label">Intermediate: Guardrails for Speed</li>
        <li><a href="guard-01-autonomy-ladder.html">1. The Autonomy Ladder</a></li>
        <li><a href="guard-02-permission-tiers.html">2. Permission Tiers</a></li>
        <li><a href="guard-03-compiler-guardrail.html">3. The Compiler as Guardrail</a></li>
        <li><a href="guard-04-deterministic-tools.html">4. Deterministic Tools Over Prompts</a></li>
        <li><a href="guard-05-hooks-as-guardrails.html">5. Hooks as Guardrails</a></li>
        <li><a href="guard-06-test-automation.html" class="current">6. Test Automation That Guards</a></li>
        <li><a href="guard-07-shift-left.html">7. Shift Left</a></li>
        <li><a href="guard-08-token-budget.html">8. Token Budget Engineering</a></li>
        <li><a href="guard-09-architectural-constraints.html">9. Architectural Constraints as Code</a></li>
        <li><a href="guard-10-building-your-pipeline.html">10. Building Your Pipeline</a></li>
      </ul>
    </nav>

  </main>

  <footer>
    <p>tmux + AI CLI &mdash; <a href="https://github.com/buildLittleWorlds/tmux-fundamentals">GitHub Repository</a></p>
  </footer>

  <script src="copy-code.js"></script>

</body>
</html>
